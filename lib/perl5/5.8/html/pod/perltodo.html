<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>perltodo - Perl TO-DO List</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:mingw-dvlpr@lists.sourceforge.net" />
</head>

<body style="background-color: white">
<table border="0" width="100%" cellspacing="0" cellpadding="3">
<tr><td class="block" style="background-color: #cccccc" valign="middle">
<big><strong><span class="block">&nbsp;perltodo - Perl TO-DO List</span></strong></big>
</td></tr>
</table>

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#the_roadmap_to_5_10">The roadmap to 5.10</a></li>
	<ul>

		<li><a href="#needed_for_a_5_9_4_release">Needed for a 5.9.4 release</a></li>
		<li><a href="#needed_for_a_5_9_5_release">Needed for a 5.9.5 release</a></li>
		<li><a href="#needed_for_a_5_9_6_release">Needed for a 5.9.6 release</a></li>
	</ul>

	<li><a href="#tasks_that_only_need_perl_knowledge">Tasks that only need Perl knowledge</a></li>
	<ul>

		<li><a href="#common_test_code_for_timed_bail_out">common test code for timed bail out</a></li>
		<li><a href="#pod___html_conversion_in_the_core_still_sucks">POD -&gt; HTML conversion in the core still sucks</a></li>
		<li><a href="#parallel_testing">Parallel testing</a></li>
		<li><a href="#make_schwern_poorer">Make Schwern poorer</a></li>
		<li><a href="#improve_the_coverage_of_the_core_tests">Improve the coverage of the core tests</a></li>
		<li><a href="#test_b">test B</a></li>
		<li><a href="#a_decent_benchmark">A decent benchmark</a></li>
		<li><a href="#fix_tainting_bugs">fix tainting bugs</a></li>
		<li><a href="#dual_life_everything">Dual life everything</a></li>
		<li><a href="#improving_threads__shared">Improving <code>threads::shared</code></a></li>
		<li><a href="#posix_memory_footprint">POSIX memory footprint</a></li>
	</ul>

	<li><a href="#tasks_that_need_a_little_sysadmintype_knowledge">Tasks that need a little sysadmin-type knowledge</a></li>
	<ul>

		<li><a href="#relocatable_perl">Relocatable perl</a></li>
		<li><a href="#make_html_install_work">make HTML install work</a></li>
		<li><a href="#compressed_man_pages">compressed man pages</a></li>
		<li><a href="#add_a_code_coverage_target_to_the_makefile">Add a code coverage target to the Makefile</a></li>
		<li><a href="#make_config_pm_cope_with_differences_between_build_and_installed_perl">Make Config.pm cope with differences between build and installed perl</a></li>
		<li><a href="#make_parallel_builds_work">make parallel builds work</a></li>
		<li><a href="#linker_specification_files">linker specification files</a></li>
	</ul>

	<li><a href="#tasks_that_need_a_little_c_knowledge">Tasks that need a little C knowledge</a></li>
	<ul>

		<li><a href="#make_it_clear_from_v_if_this_is_the_exact_official_release">Make it clear from -v if this is the exact official release</a></li>
		<li><a href="#tidy_up_global_variables">Tidy up global variables</a></li>
		<li><a href="#ordering_of_global_variables_">Ordering of ``global'' variables.</a></li>
		<li><a href="#bincompat_functions">bincompat functions</a></li>
		<li><a href="#am_i_hot_or_not">am I hot or not?</a></li>
		<li><a href="#emulate_the_perthread_memory_pool_on_unix">emulate the per-thread memory pool on Unix</a></li>
		<li><a href="#reduce_duplication_in_sv_setsv_flags">reduce duplication in sv_setsv_flags</a></li>
	</ul>

	<li><a href="#tasks_that_need_a_knowledge_of_xs">Tasks that need a knowledge of XS</a></li>
	<ul>

		<li><a href="#ipv6">IPv6</a></li>
		<li><a href="#shrink_gvs__cvs">shrink <code>GV</code>s, <code>CV</code>s</a></li>
		<li><a href="#merge_perl_sv_2_inpu_v">merge Perl_sv_2[inpu]v</a></li>
		<li><a href="#utf8_caching_code">UTF8 caching code</a></li>
		<li><a href="#implicit_latin_1____unicode_translation">Implicit Latin 1 =&gt; Unicode translation</a></li>
		<li><a href="#autovivification">autovivification</a></li>
		<li><a href="#unicode_in_filenames">Unicode in Filenames</a></li>
		<li><a href="#unicode_in__env">Unicode in %ENV</a></li>
		<li><a href="#use_less__memory_">use less 'memory'</a></li>
		<li><a href="#reimplement__unique_in_a_way_that_is_actually_threadsafe">Re-implement <code>:unique</code> in a way that is actually thread-safe</a></li>
		<li><a href="#make_tainting_consistent">Make tainting consistent</a></li>
		<li><a href="#readpipe_list_"><code>readpipe(LIST)</code></a></li>
	</ul>

	<li><a href="#tasks_that_need_a_knowledge_of_the_interpreter">Tasks that need a knowledge of the interpreter</a></li>
	<ul>

		<li><a href="#lexical_pragmas">lexical pragmas</a></li>
		<li><a href="#attach_detach_debugger_from_running_program">Attach/detach debugger from running program</a></li>
		<li><a href="#constant_folding">Constant folding</a></li>
		<li><a href="#lvalue_functions_for_lists">LVALUE functions for lists</a></li>
		<li><a href="#lvalue_functions_in_the_debugger">LVALUE functions in the debugger</a></li>
		<li><a href="#__prototype_character">_ prototype character</a></li>
		<li><a href="#state_variables">state variables</a></li>
		<li><a href="#_inc_source_filter_to_filter__simple">@INC source filter to Filter::Simple</a></li>
		<li><a href="#regexp_optimiser_optional">regexp optimiser optional</a></li>
		<li><a href="#unitcheck">UNITCHECK</a></li>
		<li><a href="#optional_optimizer">optional optimizer</a></li>
		<li><a href="#you_want__how__many">You WANT *how* many</a></li>
		<li><a href="#lexical_aliases">lexical aliases</a></li>
		<li><a href="#entersub_xs_vs_perl">entersub XS vs Perl</a></li>
		<li><a href="#self_ties">Self ties</a></li>
		<li><a href="#optimize_away___">Optimize away @_</a></li>
		<li><a href="#what_hooks_would_assertions_need">What hooks would assertions need?</a></li>
	</ul>

	<li><a href="#big_projects">Big projects</a></li>
	<ul>

		<li><a href="#make_ithreads_more_robust">make ithreads more robust</a></li>
		<li><a href="#icow">iCOW</a></li>
		<li><a href="#________closures_in_regexps">(?{...}) closures in regexps</a></li>
		<li><a href="#a_reentrant_regexp_engine">A re-entrant regexp engine</a></li>
	</ul>

</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>perltodo - Perl TO-DO List</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>This is a list of wishes for Perl. The tasks we think are smaller or easier
are listed first. Anyone is welcome to work on any of these, but it's a good
idea to first contact <em><a href="mailto:perl5-porters@perl.org">perl5-porters@perl.org</a></em> to avoid duplication of
effort. By all means contact a pumpking privately first if you prefer.</p>
<p>Whilst patches to make the list shorter are most welcome, ideas to add to
the list are also encouraged. Check the perl5-porters archives for past
ideas, and any discussion about them. One set of archives may be found at:</p>
<pre>
    <a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/</a></pre>
<p>What can we offer you in return? Fame, fortune, and everlasting glory? Maybe
not, but if your patch is incorporated, then we'll add your name to the
<em>AUTHORS</em> file, which ships in the official distribution. How many other
programming languages offer you 1 line of immortality?</p>
<p>
</p>
<hr />
<h1><a name="the_roadmap_to_5_10">The roadmap to 5.10</a></h1>
<p>The roadmap to 5.10 envisages feature based releases, as various items in this
TODO are completed.</p>
<p>
</p>
<h2><a name="needed_for_a_5_9_4_release">Needed for a 5.9.4 release</a></h2>
<ul>
<li>
<p>Review assertions. Review syntax to combine assertions. Assertions could take
advantage of the lexical pragmas work. <a href="#what_hooks_would_assertions_need">What hooks would assertions need?</a></p>
</li>
</ul>
<p>
</p>
<h2><a name="needed_for_a_5_9_5_release">Needed for a 5.9.5 release</a></h2>
<ul>
<li><strong><a name="item_implement_l_3c_2f__prototype_character_3e">Implement <a href="#__prototype_character">_ prototype character</a></a></strong>

<li><strong><a name="item_implement_l_3c_2fstate_variables_3e">Implement <a href="#state_variables">state variables</a></a></strong>

</ul>
<p>
</p>
<h2><a name="needed_for_a_5_9_6_release">Needed for a 5.9.6 release</a></h2>
<p>Stabilisation. If all goes well, this will be the equivalent of a 5.10-beta.</p>
<p>
</p>
<hr />
<h1><a name="tasks_that_only_need_perl_knowledge">Tasks that only need Perl knowledge</a></h1>
<p>
</p>
<h2><a name="common_test_code_for_timed_bail_out">common test code for timed bail out</a></h2>
<p>Write portable self destruct code for tests to stop them burning CPU in
infinite loops. This needs to avoid using alarm, as some of the tests are
testing alarm/sleep or timers.</p>
<p>
</p>
<h2><a name="pod___html_conversion_in_the_core_still_sucks">POD -&gt; HTML conversion in the core still sucks</a></h2>
<p>Which is crazy given just how simple POD purports to be, and how simple HTML
can be. It's not actually <em>as</em> simple as it sounds, particularly with the
flexibility POD allows for <code>=item</code>, but it would be good to improve the
visual appeal of the HTML generated, and to avoid it having any validation
errors. See also <a href="#make_html_install_work">make HTML install work</a>, as the layout of installation tree
is needed to improve the cross-linking.</p>
<p>The addition of <code>Pod::Simple</code> and its related modules may make this task
easier to complete.</p>
<p>
</p>
<h2><a name="parallel_testing">Parallel testing</a></h2>
<p>The core regression test suite is getting ever more comprehensive, which has
the side effect that it takes longer to run. This isn't so good. Investigate
whether it would be feasible to give the harness script the <strong>option</strong> of
running sets of tests in parallel. This would be useful for tests in
<em>t/op/*.t</em> and <em>t/uni/*.t</em> and maybe some sets of tests in <em>lib/</em>.</p>
<p>Questions to answer</p>
<ol>
<li>
<p>How does screen layout work when you're running more than one test?</p>
</li>
<li>
<p>How does the caller of test specify how many tests to run in parallel?</p>
</li>
<li>
<p>How do setup/teardown tests identify themselves?</p>
</li>
</ol>
<p>Pugs already does parallel testing - can their approach be re-used?</p>
<p>
</p>
<h2><a name="make_schwern_poorer">Make Schwern poorer</a></h2>
<p>We should have for everything. When all the core's modules are tested,
Schwern has promised to donate to $500 to TPF. We may need volunteers to
hold him upside down and shake vigorously in order to actually extract the
cash.</p>
<p>See <em>t/lib/1_compile.t</em> for the 3 remaining modules that need tests.</p>
<p>
</p>
<h2><a name="improve_the_coverage_of_the_core_tests">Improve the coverage of the core tests</a></h2>
<p>Use Devel::Cover to ascertain the core's test coverage, then add tests that
are currently missing.</p>
<p>
</p>
<h2><a name="test_b">test B</a></h2>
<p>A full test suite for the B module would be nice.</p>
<p>
</p>
<h2><a name="a_decent_benchmark">A decent benchmark</a></h2>
<p><code>perlbench</code> seems impervious to any recent changes made to the perl core. It
would be useful to have a reasonable general benchmarking suite that roughly
represented what current perl programs do, and measurably reported whether
tweaks to the core improve, degrade or don't really affect performance, to
guide people attempting to optimise the guts of perl. Gisle would welcome
new tests for perlbench.</p>
<p>
</p>
<h2><a name="fix_tainting_bugs">fix tainting bugs</a></h2>
<p>Fix the bugs revealed by running the test suite with the <code>-t</code> switch (via
<code>make test.taintwarn</code>).</p>
<p>
</p>
<h2><a name="dual_life_everything">Dual life everything</a></h2>
<p>As part of the ``dists'' plan, anything that doesn't belong in the smallest perl
distribution needs to be dual lifed. Anything else can be too. Figure out what
changes would be needed to package that module and its tests up for CPAN, and
do so. Test it with older perl releases, and fix the problems you find.</p>
<p>
</p>
<h2><a name="improving_threads__shared">Improving <code>threads::shared</code></a></h2>
<p>Investigate whether <code>threads::shared</code> could share aggregates properly with
only Perl level changes to shared.pm</p>
<p>
</p>
<h2><a name="posix_memory_footprint">POSIX memory footprint</a></h2>
<p>Ilya observed that use POSIX; eats memory like there's no tomorrow, and at
various times worked to cut it down. There is probably still fat to cut out -
for example POSIX passes Exporter some very memory hungry data structures.</p>
<p>
</p>
<hr />
<h1><a name="tasks_that_need_a_little_sysadmintype_knowledge">Tasks that need a little sysadmin-type knowledge</a></h1>
<p>Or if you prefer, tasks that you would learn from, and broaden your skills
base...</p>
<p>
</p>
<h2><a name="relocatable_perl">Relocatable perl</a></h2>
<p>The C level patches needed to create a relocatable perl binary are done, as
is the work on <em>Config.pm</em>. All that's left to do is the <code>Configure</code> tweaking
to let people specify how they want to do the install.</p>
<p>
</p>
<h2><a name="make_html_install_work">make HTML install work</a></h2>
<p>There is an <code>installhtml</code> target in the Makefile. It's marked as
``experimental''. It would be good to get this tested, make it work reliably, and
remove the ``experimental'' tag. This would include</p>
<ol>
<li>
<p>Checking that cross linking between various parts of the documentation works.
In particular that links work between the modules (files with POD in <em>lib/</em>)
and the core documentation (files in <em>pod/</em>)</p>
</li>
<li>
<p>Work out how to split <code>perlfunc</code> into chunks, preferably one per function
group, preferably with general case code that could be used elsewhere.
Challenges here are correctly identifying the groups of functions that go
together, and making the right named external cross-links point to the right
page. Things to be aware of are <code>-X</code>, groups such as <code>getpwnam</code> to
<code>endservent</code>, two or more <code>=items</code> giving the different parameter lists, such
as</p>
<pre>
    =item substr EXPR,OFFSET,LENGTH,REPLACEMENT
    
    =item substr EXPR,OFFSET,LENGTH
    
    =item substr EXPR,OFFSET</pre>
<p>and different parameter lists having different meanings. (eg <code>select</code>)</p>
</li>
</ol>
<p>
</p>
<h2><a name="compressed_man_pages">compressed man pages</a></h2>
<p>Be able to install them. This would probably need a configure test to see how
the system does compressed man pages (same directory/different directory?
same filename/different filename), as well as tweaking the <em>installman</em> script
to compress as necessary.</p>
<p>
</p>
<h2><a name="add_a_code_coverage_target_to_the_makefile">Add a code coverage target to the Makefile</a></h2>
<p>Make it easy for anyone to run Devel::Cover on the core's tests. The steps
to do this manually are roughly</p>
<ul>
<li>
<p>do a normal <code>Configure</code>, but include Devel::Cover as a module to install
(see <em>INSTALL</em> for how to do this)</p>
</li>
<li>
<pre>
    make perl</pre>
<li>
<pre>
    cd t; HARNESS_PERL_SWITCHES=-MDevel::Cover ./perl -I../lib harness</pre>
<li>
<p>Process the resulting Devel::Cover database</p>
</li>
</ul>
<p>This just give you the coverage of the <em>.pm</em>s. To also get the C level
coverage you need to</p>
<ul>
<li>
<p>Additionally tell <code>Configure</code> to use the appropriate C compiler flags for
<code>gcov</code></p>
</li>
<li>
<pre>
    make perl.gcov</pre>
<p>(instead of <code>make perl</code>)</p>
<li>
<p>After running the tests run <code>gcov</code> to generate all the <em>.gcov</em> files.
(Including down in the subdirectories of <em>ext/</em></p>
</li>
<li>
<p>(From the top level perl directory) run <code>gcov2perl</code> on all the <code>.gcov</code> files
to get their stats into the cover_db directory.</p>
</li>
<li>
<p>Then process the Devel::Cover database</p>
</li>
</ul>
<p>It would be good to add a single switch to <code>Configure</code> to specify that you
wanted to perform perl level coverage, and another to specify C level
coverage, and have <code>Configure</code> and the <em>Makefile</em> do all the right things
automatically.</p>
<p>
</p>
<h2><a name="make_config_pm_cope_with_differences_between_build_and_installed_perl">Make Config.pm cope with differences between build and installed perl</a></h2>
<p>Quite often vendors ship a perl binary compiled with their (pay-for)
compilers.  People install a free compiler, such as gcc. To work out how to
build extensions, Perl interrogates <code>%Config</code>, so in this situation
<code>%Config</code> describes compilers that aren't there, and extension building
fails. This forces people into choosing between re-compiling perl themselves
using the compiler they have, or only using modules that the vendor ships.</p>
<p>It would be good to find a way teach <code>Config.pm</code> about the installation setup,
possibly involving probing at install time or later, so that the <code>%Config</code> in
a binary distribution better describes the installed machine, when the
installed machine differs from the build machine in some significant way.</p>
<p>
</p>
<h2><a name="make_parallel_builds_work">make parallel builds work</a></h2>
<p>Currently parallel builds (such as <code>make -j3</code>) don't work reliably. We believe
that this is due to incomplete dependency specification in the <em>Makefile</em>.
It would be good if someone were able to track down the causes of these
problems, so that parallel builds worked properly.</p>
<p>
</p>
<h2><a name="linker_specification_files">linker specification files</a></h2>
<p>Some platforms mandate that you provide a list of a shared library's external
symbols to the linker, so the core already has the infrastructure in place to
do this for generating shared perl libraries. My understanding is that the
GNU toolchain can accept an optional linker specification file, and restrict
visibility just to symbols declared in that file. It would be good to extend
<em>makedef.pl</em> to support this format, and to provide a means within
<code>Configure</code> to enable it. This would allow Unix users to test that the
export list is correct, and to build a perl that does not pollute the global
namespace with private symbols.</p>
<p>
</p>
<hr />
<h1><a name="tasks_that_need_a_little_c_knowledge">Tasks that need a little C knowledge</a></h1>
<p>These tasks would need a little C knowledge, but don't need any specific
background or experience with XS, or how the Perl interpreter works</p>
<p>
</p>
<h2><a name="make_it_clear_from_v_if_this_is_the_exact_official_release">Make it clear from -v if this is the exact official release</a></h2>
<p>Currently perl from <code>p4</code>/<code>rsync</code> ships with a <em>patchlevel.h</em> file that
usually defines one local patch, of the form ``MAINT12345'' or ``RC1''. The output
of perl -v doesn't report that a perl isn't an official release, and this
information can get lost in bugs reports. Because of this, the minor version
isn't bumped up until RC time, to minimise the possibility of versions of perl
escaping that believe themselves to be newer than they actually are.</p>
<p>It would be useful to find an elegant way to have the ``this is an interim
maintenance release'' or ``this is a release candidate'' in the terse -v output,
and have it so that it's easy for the pumpking to remove this just as the
release tarball is rolled up. This way the version pulled out of rsync would
always say ``I'm a development release'' and it would be safe to bump the
reported minor version as soon as a release ships, which would aid perl
developers.</p>
<p>This task is really about thinking of an elegant way to arrange the C source
such that it's trivial for the Pumpking to flag ``this is an official release''
when making a tarball, yet leave the default source saying ``I'm not the
official release''.</p>
<p>
</p>
<h2><a name="tidy_up_global_variables">Tidy up global variables</a></h2>
<p>There's a note in <em>intrpvar.h</em></p>
<pre>
  /* These two variables are needed to preserve 5.8.x bincompat because
     we can't change function prototypes of two exported functions.
     Probably should be taken out of blead soon, and relevant prototypes
     changed.  */</pre>
<p>So doing this, and removing any of the unused variables still present would
be good.</p>
<p>
</p>
<h2><a name="ordering_of_global_variables_">Ordering of ``global'' variables.</a></h2>
<p><em>thrdvar.h</em> and <em>intrpvarh</em> define the ``global'' variables that need to be
per-thread under ithreads, where the variables are actually elements in a
structure. As C dictates, the variables must be laid out in order of
declaration. There is a comment
<code>/* Important ones in the first cache line (if alignment is done right) */</code>
which implies that at some point in the past the ordering was carefully chosen
(at least in part). However, it's clear that the ordering is less than perfect,
as currently there are things such as 7 <code>bool</code>s in a row, then something
typically requiring 4 byte alignment, and then an odd <code>bool</code> later on.
(<code>bool</code>s are typically defined as <code>char</code>s). So it would be good for someone
to review the ordering of the variables, to see how much alignment padding can
be removed.</p>
<p>
</p>
<h2><a name="bincompat_functions">bincompat functions</a></h2>
<p>There are lots of functions which are retained for binary compatibility.
Clean these up. Move them to mathom.c, and don't compile for blead?</p>
<p>
</p>
<h2><a name="am_i_hot_or_not">am I hot or not?</a></h2>
<p>The idea of <em>pp_hot.c</em> is that it contains the <em>hot</em> ops, the ops that are
most commonly used. The idea is that by grouping them, their object code will
be adjacent in the executable, so they have a greater chance of already being
in the CPU cache (or swapped in) due to being near another op already in use.</p>
<p>Except that it's not clear if these really are the most commonly used ops. So
anyone feeling like exercising their skill with coverage and profiling tools
might want to determine what ops <em>really</em> are the most commonly used. And in
turn suggest evictions and promotions to achieve a better <em>pp_hot.c</em>.</p>
<p>
</p>
<h2><a name="emulate_the_perthread_memory_pool_on_unix">emulate the per-thread memory pool on Unix</a></h2>
<p>For Windows, ithreads allocates memory for each thread from a separate pool,
which it discards at thread exit. It also checks that memory is free()d to
the correct pool. Neither check is done on Unix, so code developed there won't
be subject to such strictures, so can harbour bugs that only show up when the
code reaches Windows.</p>
<p>It would be good to be able to optionally emulate the Window pool system on
Unix, to let developers who only have access to Unix, or want to use
Unix-specific debugging tools, check for these problems. To do this would
involve figuring out how the <code>PerlMem_*</code> macros wrap <code>malloc()</code> access, and
providing a layer that records/checks the identity of the thread making the
call, and recording all the memory allocated by each thread via this API so
that it can be summarily free()d at thread exit. One implementation idea
would be to increase the size of allocation, and store the <code>my_perl</code> pointer
(to identify the thread) at the start, along with pointers to make a linked
list of blocks for this thread. To avoid alignment problems it would be
necessary to do something like</p>
<pre>
  union memory_header_padded {
    struct memory_header {
      void *thread_id;   /* For my_perl */
      void *next;        /* Pointer to next block for this thread */
    } data;
    long double padding; /* whatever type has maximal alignment constraint */
  };</pre>
<p>although <code>long double</code> might not be the only type to add to the padding
union.</p>
<p>
</p>
<h2><a name="reduce_duplication_in_sv_setsv_flags">reduce duplication in sv_setsv_flags</a></h2>
<p><code>Perl_sv_setsv_flags</code> has a comment
<code>/* There's a lot of redundancy below but we're going for speed here */</code></p>
<p>Whilst this was true 10 years ago, the growing disparity between RAM and CPU
speeds mean that the trade offs have changed. In addition, the duplicate code
adds to the maintenance burden. It would be good to see how much of the
redundancy can be pruned, particular in the less common paths. (Profiling
tools at the ready...). For example, why does the test for
``Can't redefine active sort subroutine'' need to occur in two places?</p>
<p>
</p>
<hr />
<h1><a name="tasks_that_need_a_knowledge_of_xs">Tasks that need a knowledge of XS</a></h1>
<p>These tasks would need C knowledge, and roughly the level of knowledge of
the perl API that comes from writing modules that use XS to interface to
C.</p>
<p>
</p>
<h2><a name="ipv6">IPv6</a></h2>
<p>Clean this up. Check everything in core works</p>
<p>
</p>
<h2><a name="shrink_gvs__cvs">shrink <code>GV</code>s, <code>CV</code>s</a></h2>
<p>By removing unused elements and careful re-ordering, the structures for <code>AV</code>s
and <code>HV</code>s have recently been shrunk considerably. It's probable that the same
approach would find savings in <code>GV</code>s and <code>CV</code>s, if not all the other
larger-than-<code>PVMG</code> types.</p>
<p>
</p>
<h2><a name="merge_perl_sv_2_inpu_v">merge Perl_sv_2[inpu]v</a></h2>
<p>There's a lot of code shared between <code>Perl_sv_2iv_flags</code>,
<code>Perl_sv_2uv_flags</code>, <code>Perl_sv_2nv</code>, and <code>Perl_sv_2pv_flags</code>. It would be
interesting to see if some of it can be merged into common shared static
functions. In particular, <code>Perl_sv_2uv_flags</code> started out as a cut&amp;paste
from <code>Perl_sv_2iv_flags</code> around 5.005_50 time, and it may be possible to
replace both with a single function that returns a value or union which is
split out by the macros in <em>sv.h</em></p>
<p>
</p>
<h2><a name="utf8_caching_code">UTF8 caching code</a></h2>
<p>The string position/offset cache is not optional. It should be.</p>
<p>
</p>
<h2><a name="implicit_latin_1____unicode_translation">Implicit Latin 1 =&gt; Unicode translation</a></h2>
<p>Conversions from byte strings to UTF-8 currently map high bit characters
to Unicode without translation (or, depending on how you look at it, by
implicitly assuming that the byte strings are in Latin-1). As perl assumes
the C locale by default, upgrading a string to UTF-8 may change the
meaning of its contents regarding character classes, case mapping, etc.
This should probably emit a warning (at least).</p>
<p>This task is incremental - even a little bit of work on it will help.</p>
<p>
</p>
<h2><a name="autovivification">autovivification</a></h2>
<p>Make all autovivification consistent w.r.t LVALUE/RVALUE and strict/no strict;</p>
<p>This task is incremental - even a little bit of work on it will help.</p>
<p>
</p>
<h2><a name="unicode_in_filenames">Unicode in Filenames</a></h2>
<p>chdir, chmod, chown, chroot, exec, glob, link, lstat, mkdir, open,
opendir, qx, readdir, readlink, rename, rmdir, stat, symlink, sysopen,
system, truncate, unlink, utime, -X.  All these could potentially accept
Unicode filenames either as input or output (and in the case of system
and qx Unicode in general, as input or output to/from the shell).
Whether a filesystem - an operating system pair understands Unicode in
filenames varies.</p>
<p>Known combinations that have some level of understanding include
Microsoft NTFS, Apple HFS+ (In Mac OS 9 and X) and Apple UFS (in Mac
OS X), NFS v4 is rumored to be Unicode, and of course Plan 9.  How to
create Unicode filenames, what forms of Unicode are accepted and used
(UCS-2, UTF-16, UTF-8), what (if any) is the normalization form used,
and so on, varies.  Finding the right level of interfacing to Perl
requires some thought.  Remember that an OS does not implicate a
filesystem.</p>
<p>(The Windows -C command flag ``wide API support'' has been at least
temporarily retired in 5.8.1, and the -C has been repurposed, see
<a href="/usr/lib/perl5/5.8/html/./pod/perlrun.html">the perlrun manpage</a>.)</p>
<p>
</p>
<h2><a name="unicode_in__env">Unicode in %ENV</a></h2>
<p>Currently the %ENV entries are always byte strings.</p>
<p>
</p>
<h2><a name="use_less__memory_">use less 'memory'</a></h2>
<p>Investigate trade offs to switch out perl's choices on memory usage.
Particularly perl should be able to give memory back.</p>
<p>This task is incremental - even a little bit of work on it will help.</p>
<p>
</p>
<h2><a name="reimplement__unique_in_a_way_that_is_actually_threadsafe">Re-implement <code>:unique</code> in a way that is actually thread-safe</a></h2>
<p>The old implementation made bad assumptions on several levels. A good 90%
solution might be just to make <code>:unique</code> work to share the string buffer
of SvPVs. That way large constant strings can be shared between ithreads,
such as the configuration information in <em>Config</em>.</p>
<p>
</p>
<h2><a name="make_tainting_consistent">Make tainting consistent</a></h2>
<p>Tainting would be easier to use if it didn't take documented shortcuts and
allow taint to ``leak'' everywhere within an expression.</p>
<p>
</p>
<h2><a name="readpipe_list_"><code>readpipe(LIST)</code></a></h2>
<p><code>system()</code> accepts a LIST syntax (and a PROGRAM LIST syntax) to avoid
running a shell. <code>readpipe()</code> (the function behind qx//) could be similarly
extended.</p>
<p>
</p>
<hr />
<h1><a name="tasks_that_need_a_knowledge_of_the_interpreter">Tasks that need a knowledge of the interpreter</a></h1>
<p>These tasks would need C knowledge, and knowledge of how the interpreter works,
or a willingness to learn.</p>
<p>
</p>
<h2><a name="lexical_pragmas">lexical pragmas</a></h2>
<p>Document the new support for lexical pragmas in 5.9.3 and how %^H works.
Maybe <code>re</code>, <code>encoding</code>, maybe other pragmas could be made lexical.</p>
<p>
</p>
<h2><a name="attach_detach_debugger_from_running_program">Attach/detach debugger from running program</a></h2>
<p>The old perltodo notes ``With <code>gdb</code>, you can attach the debugger to a running
program if you pass the process ID. It would be good to do this with the Perl
debugger on a running Perl program, although I'm not sure how it would be
done.'' ssh and screen do this with named pipes in /tmp. Maybe we can too.</p>
<p>
</p>
<h2><a name="constant_folding">Constant folding</a></h2>
<p>The peephole optimiser should trap errors during constant folding, and give
up on the folding, rather than bailing out at compile time.  It is quite
possible that the unfoldable constant is in unreachable code, eg something
akin to <a href="/usr/lib/perl5/5.8/html/./pod/perlvar.html#item__a"><code>$a = 0/0 if 0;</code></a></p>
<p>
</p>
<h2><a name="lvalue_functions_for_lists">LVALUE functions for lists</a></h2>
<p>The old perltodo notes that lvalue functions don't work for list or hash
slices. This would be good to fix.</p>
<p>
</p>
<h2><a name="lvalue_functions_in_the_debugger">LVALUE functions in the debugger</a></h2>
<p>The old perltodo notes that lvalue functions don't work in the debugger. This
would be good to fix.</p>
<p>
</p>
<h2><a name="__prototype_character">_ prototype character</a></h2>
<p>Study the possibility of adding a new prototype character, <code>_</code>, meaning
``this argument defaults to $_''.</p>
<p>
</p>
<h2><a name="state_variables">state variables</a></h2>
<p><code>my $foo if 0;</code> is deprecated, and should be replaced with
<code>state $x = &quot;initial value\n&quot;;</code> the syntax from Perl 6.</p>
<p>
</p>
<h2><a name="_inc_source_filter_to_filter__simple">@INC source filter to Filter::Simple</a></h2>
<p>The second return value from a sub in @INC can be a source filter. This isn't
documented. It should be changed to use Filter::Simple, tested and documented.</p>
<p>
</p>
<h2><a name="regexp_optimiser_optional">regexp optimiser optional</a></h2>
<p>The regexp optimiser is not optional. It should configurable to be, to allow
its performance to be measured, and its bugs to be easily demonstrated.</p>
<p>
</p>
<h2><a name="unitcheck">UNITCHECK</a></h2>
<p>Introduce a new special block, UNITCHECK, which is run at the end of a
compilation unit (module, file, <code>eval(STRING)</code> block). This will correspond to
the Perl 6 CHECK. Perl 5's CHECK cannot be changed or removed because the
O.pm/B.pm backend framework depends on it.</p>
<p>
</p>
<h2><a name="optional_optimizer">optional optimizer</a></h2>
<p>Make the peephole optimizer optional. Currently it performs two tasks as
it walks the optree - genuine peephole optimisations, and necessary fixups of
ops. It would be good to find an efficient way to switch out the
optimisations whilst keeping the fixups.</p>
<p>
</p>
<h2><a name="you_want__how__many">You WANT *how* many</a></h2>
<p>Currently contexts are void, scalar and list. split has a special mechanism in
place to pass in the number of return values wanted. It would be useful to
have a general mechanism for this, backwards compatible and little speed hit.
This would allow proposals such as short circuiting sort to be implemented
as a module on CPAN.</p>
<p>
</p>
<h2><a name="lexical_aliases">lexical aliases</a></h2>
<p>Allow lexical aliases (maybe via the syntax <code>my \$alias = \$foo</code>.</p>
<p>
</p>
<h2><a name="entersub_xs_vs_perl">entersub XS vs Perl</a></h2>
<p>At the moment pp_entersub is huge, and has code to deal with entering both
perl and XS subroutines. Subroutine implementations rarely change between 
perl and XS at run time, so investigate using 2 ops to enter subs (one for
XS, one for perl) and swap between if a sub is redefined.</p>
<p>
</p>
<h2><a name="self_ties">Self ties</a></h2>
<p>self ties are currently illegal because they caused too many segfaults. Maybe
the causes of these could be tracked down and self-ties on all types re-
instated.</p>
<p>
</p>
<h2><a name="optimize_away___">Optimize away @_</a></h2>
<p>The old perltodo notes ``Look at the ''reification`` code in <code>av.c</code>''.</p>
<p>
</p>
<h2><a name="what_hooks_would_assertions_need">What hooks would assertions need?</a></h2>
<p>Assertions are in the core, and work. However, assertions needed to be added
as a core patch, rather than an XS module in ext, or a CPAN module, because
the core has no hooks in the necessary places. It would be useful to
investigate what hooks would need to be added to make it possible to provide
the full assertion support from a CPAN module, so that we aren't constraining
the imagination of future CPAN authors.</p>
<p>
</p>
<hr />
<h1><a name="big_projects">Big projects</a></h1>
<p>Tasks that will get your name mentioned in the description of the ``Highlights
of 5.10''</p>
<p>
</p>
<h2><a name="make_ithreads_more_robust">make ithreads more robust</a></h2>
<p>Generally make ithreads more robust. See also <a href="#icow">iCOW</a></p>
<p>This task is incremental - even a little bit of work on it will help, and
will be greatly appreciated.</p>
<p>
</p>
<h2><a name="icow">iCOW</a></h2>
<p>Sarathy and Arthur have a proposal for an improved Copy On Write which
specifically will be able to COW new ithreads. If this can be implemented
it would be a good thing.</p>
<p>
</p>
<h2><a name="________closures_in_regexps">(?{...}) closures in regexps</a></h2>
<p>Fix (or rewrite) the implementation of the <code>/(?{...})/</code> closures.</p>
<p>
</p>
<h2><a name="a_reentrant_regexp_engine">A re-entrant regexp engine</a></h2>
<p>This will allow the use of a regex from inside (?{ }), (??{ }) and
(?(?{ })|) constructs.</p>
<table border="0" width="100%" cellspacing="0" cellpadding="3">
<tr><td class="block" style="background-color: #cccccc" valign="middle">
<big><strong><span class="block">&nbsp;perltodo - Perl TO-DO List</span></strong></big>
</td></tr>
</table>

</body>

</html>
