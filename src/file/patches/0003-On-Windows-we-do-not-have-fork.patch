From 6283f73679f495e02c13324764afa940461470d5 Mon Sep 17 00:00:00 2001
From: Johannes Schindelin <johannes.schindelin@gmx.de>
Date: Mon, 7 Dec 2009 17:21:52 +0100
Subject: [PATCH 3/7] On Windows, we do not have fork()

Unfortunately, that means that we cannot easily uncompress if it is
not covered by libz.

Signed-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>
---
 src/compress.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/compress.c b/src/compress.c
index 10b2158..40b11bd 100644
--- a/src/compress.c
+++ b/src/compress.c
@@ -382,6 +382,10 @@ uncompressbuf(struct magic_set *ms, int fd, size_t method,
 	if (method == 2)
 		return uncompressgzipped(ms, old, newch, n);
 #endif
+#ifdef WIN32
+	file_printf(ms, "Cannot uncompress (fork) on Windows");
+	return NODATA;
+#else
 	(void)fflush(stdout);
 	(void)fflush(stderr);
 
@@ -495,4 +499,5 @@ err:
 	    
 		return n;
 	}
+#endif /* WIN32 */
 }
-- 
1.9.5.msysgit.0.4.gceda007

